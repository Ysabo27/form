<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html lang="he">
<head>
<meta charset="utf-8" />
<title>טופס</title>

<!-- כל ה-CSS וה-JS של Jotform נשארים כמו אצלך -->
<link rel="stylesheet" href="https://cdn.jotfor.ms/stylebuilder/static/form-common.css" />

</head>

<body>

<form id="253443389862064" class="jotform-form">

  <!-- ===== מספר זהות ===== -->
  <div class="form-line" id="id_66">
    <label for="input_66">מספר זהות</label>
    <input
      type="text"
      id="input_66"
      name="q66_input66"
      inputmode="numeric"
      maxlength="9"
      autocomplete="off"
      placeholder="9 ספרות"
    />
  </div>

  <!-- כפתור המשך -->
  <button
    type="button"
    class="form-submit-button useJotformSign-button">
    המשך
  </button>

</form>

<!-- ===== אימות ת״ז בזמן מילוי ===== -->
<script>
/* אימות תעודת זהות ישראלית */
function isValidIsraeliId(value) {
  let str = String(value || "").replace(/\D/g, "");
  if (str.length > 9) return false;
  while (str.length < 9) str = "0" + str;

  let sum = 0;
  for (let i = 0; i < 9; i++) {
    let n = Number(str[i]) * ((i % 2) + 1);
    if (n > 9) n -= 9;
    sum += n;
  }
  return sum % 10 === 0;
}

document.addEventListener("DOMContentLoaded", () => {
  const tzInput = document.getElementById("input_66");
  const btn = document.querySelector(".useJotformSign-button");

  if (!tzInput || !btn) return;

  // רק ספרות + עד 9
  tzInput.addEventListener("input", () => {
    tzInput.value = tzInput.value.replace(/\D/g, "").slice(0, 9);

    if (tzInput.value.length === 9) {
      validate();
    } else {
      tzInput.setCustomValidity("יש להזין 9 ספרות");
    }
  });

  tzInput.addEventListener("blur", validate);

  function validate() {
    const ok = isValidIsraeliId(tzInput.value);
    tzInput.setCustomValidity(ok ? "" : "תעודת זהות לא תקינה");
    if (!ok) tzInput.reportValidity();
    return ok;
  }

  // חסימת התקדמות
  btn.addEventListener("click", (e) => {
    if (!validate()) {
      e.preventDefault();
      e.stopPropagation();
    }
  }, true);
});
</script>

</body>
</html>
